{% extends "backendbase.html.twig" %}
{% block title %} User Management {% endblock %}
{% block body %}

{% for message in app.flashes('message')%}
    <div>
        <div>
            <div class="p-3 my-2 rounded -2 success" >{{message}}</div>
        </div>
    </div>
{% endfor %}
	<div class="row">
		<div class="col-lg-12">
			<div class="card">
				<form action="{{ path('app_admin_userManagement') }}" method="get" class="form-inline mb-3">
            		<div class="form-group">
                		<input type="text" name="q" class="form-control" placeholder="Search by email...">
            		</div>
            		<button type="submit" class="btn btn-primary ml-2">Search</button>
        		</form>

				


				<div class="card-body">
					<div class="table-responsive">
						<table id="userTable" class="table table-bordered verticle-middle table-responsive-sm">
							<thead>
								<tr>
									<th scope="col">ID</th>
									<th scope="col">E-mail</th>
									<th scope="col">Role</th>
									<th scope="col">Username</th>
									<th scope="col">First Name</th>
									<th scope="col">Last Name</th>
									<th scope="col">Birthday</th>
									<th scope="col">Gender</th>
									<th scope="col">Phone Number</th>
									<th scope="col">Level</th>
									<th scope="col">Pictures</th>
									<th scope="col">Actions</th>
								</tr>
							</thead>
							<tbody>
								{% for user in users %}
									<tr>
										<td>{{user.getId}}</td>

										<td>{{user.Email}}</td>

										<td>
											<ul>
												{% for role in user.getRoles %}
													<li>{{ role }}</li>
												{% endfor %}
											</ul>
										</td>

										<td>{{user.getUserusername}}</td>

										<td>{{user.getUserfirstname}}</td>

										<td>{{user.getUserlastname}}</td>

										<td>{{ user.getUserbirthday | date('Y-m-d') }}</td>

										<td>{{ user.getUserGender}}</td>

										<td>
											{{ user.getUserPhonenumber}}
										</td>

										<td>
											{{ user.getUserLevel}}
										</td>
										<td>
											<img src="../Images/ProfileImages/{{user.userPicture}}" alt="{{ user.userPicture }}" style="max-width: 100px; height: auto; width: 100px; height: 100px;"/>
										</td>
										<td>
											<a class="badge badge-danger" href="{{path('app_admin_userManagement_deleteUser',{'id':user.id})}}">Delete</a>
										</td>

									</tr>
								{% endfor %}
								

							</tbody>

						</table>
						{{ knp_pagination_render(users) }}

					</div>
				</div>
			</div>
		</div>
	</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
        $(document).ready(function(){
            $('#searchbarinput').keyup(function(){
                search_table($(this).val());
            });
            function search_table(value){
                $('#userTable tbody tr').each(function(){
                    var found = false;
                    $(this).find('td:nth-child(4)').each(function(){
                        if($(this).text().toLowerCase().includes(value.toLowerCase())){
                            found = true;
                            return false;
                        }
                    });
                    if(found){
                        $(this).show();
                    } else {
                        $(this).hide();
                    }
                });
            }
        });
    </script>

<style>

        span{margin: 0;padding: 0;}
        .pagination {
			margin-top: 1rem;
            display: flex;
            justify-content: center;
            list-style-type: none;
            padding: 0;
            gap:.25em;
        }

        .pagination li {
            margin: 0 5px;
        }

        .pagination a {
            text-decoration: none;
            color: #007bff;
            border: 1px solid #007bff;
            padding: 6px 12px;
            border-radius: 4px;
            transition: background-color 0.3s ease;
        }

        .pagination a:hover {
            background-color: #007bff;
            color: #fff;
        }

        .pagination .current {
            font-weight: bold;
            background-color: #007bff;
            color: #fff;
            border: 1px solid #007bff;
            padding: 6px 12px;
            border-radius: 4px;
            margin-top: -7px;            
        }

</style>



{% endblock %}
